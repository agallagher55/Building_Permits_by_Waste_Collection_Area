# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-02-28 13:26:02
"""
import arcpy


def SolidWasteDwellingUnits():  # Solid Waste Dwelling Units Analysis

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    arcpy.ImportToolbox(r"c:\program files\arcgis\pro\Resources\ArcToolbox\toolboxes\GeoAnalytics Desktop Tools.tbx")
    arcpy.ImportToolbox(r"c:\program files\arcgis\pro\Resources\ArcToolbox\toolboxes\Conversion Tools.tbx")
    SDEADM_BLD_building_polygon_2_ = "SDEADM.BLD_building_polygon"
    SolidWaste_DwellingUnitAnalysis_gdb_5_ = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb"
    SDEADM_ADM_waste_coll_area_2_ = "SDEADM.ADM_waste_coll_area"
    SolidWaste_DwellingUnitAnalysis_gdb_6_ = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb"
    SDEADM_BLD_BUILDING_USE_2_ = "SDEADM.BLD_BUILDING_USE"
    SolidWaste_DwellingUnitAnalysis_gdb_2_ = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb"

    # Process: Feature Class to Feature Class (Feature Class to Feature Class) (conversion)
    Building_Polygons = arcpy.conversion.FeatureClassToFeatureClass(in_features=SDEADM_BLD_building_polygon_2_, out_path=SolidWaste_DwellingUnitAnalysis_gdb_5_, out_name="Building_Polygons", where_clause="", field_mapping="BLPOLY_ID \"BLPOLY_ID\" false true false 16 Text 0 0,First,#,SDEADM.BLD_building_polygon,BLPOLY_ID,0,16;BL_ID \"BL_ID\" true true false 16 Text 0 0,First,#,SDEADM.BLD_building_polygon,BL_ID,0,16;FCODE \"Building Fcode\" true true false 12 Text 0 0,First,#,SDEADM.BLD_building_polygon,FCODE,0,12;ZVALUE \"Z Value\" true true false 8 Double 8 38,First,#,SDEADM.BLD_building_polygon,ZVALUE,-1,-1;FOOT_SQFT \"Footprint SqFt\" true true false 4 Long 0 10,First,#,SDEADM.BLD_building_polygon,FOOT_SQFT,-1,-1;FLOORS \"Number of Floors\" true true false 8 Double 8 38,First,#,SDEADM.BLD_building_polygon,FLOORS,-1,-1;SCALE \"Scale\" true true false 8 Text 0 0,First,#,SDEADM.BLD_building_polygon,SCALE,0,8;ADDDATE \"ADDDATE\" false true false 8 Date 0 0,First,#,SDEADM.BLD_building_polygon,ADDDATE,-1,-1;SOURCE \"SOURCE\" true true false 15 Text 0 0,First,#,SDEADM.BLD_building_polygon,SOURCE,0,15;SACC \"SACC\" true true false 2 Text 0 0,First,#,SDEADM.BLD_building_polygon,SACC,0,2;MODDATE \"MODDATE\" false true false 8 Date 0 0,First,#,SDEADM.BLD_building_polygon,MODDATE,-1,-1;LOAD_ID \"Load ID\" true true false 16 Text 0 0,First,#,SDEADM.BLD_building_polygon,LOAD_ID,0,16;GLOBALID \"GLOBALID\" false false false 38 GlobalID 0 0,First,#,SDEADM.BLD_building_polygon,GLOBALID,-1,-1;ADDBY \"Add by\" false true false 32 Text 0 0,First,#,SDEADM.BLD_building_polygon,ADDBY,0,32;MODBY \"Modified by\" false true false 32 Text 0 0,First,#,SDEADM.BLD_building_polygon,MODBY,0,32", config_keyword="")[0]

    # Process: Dissolve (Dissolve) (management)
    Building_Polygons_Dissolve = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Building_Polygons_Dissolve"
    arcpy.management.Dissolve(
        in_features=Building_Polygons,
        out_feature_class=Building_Polygons_Dissolve,
        dissolve_field=["BL_ID"],
        statistics_fields=[],
        multi_part="MULTI_PART",
        unsplit_lines="DISSOLVE_LINES"
    )

    # Process: Feature Class to Feature Class (3) (Feature Class to Feature Class) (conversion)
    Waste_Collection_Areas_2_ = arcpy.conversion.FeatureClassToFeatureClass(in_features=SDEADM_ADM_waste_coll_area_2_, out_path=SolidWaste_DwellingUnitAnalysis_gdb_6_, out_name="Waste_Collection_Areas", where_clause="", field_mapping="OPERATOR \"OPERATOR\" true true false 8 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,OPERATOR,0,8;COLLECT \"COLLECT\" true true false 10 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,COLLECT,0,10;COLL_AREA \"COLL_AREA\" true true false 7 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,COLL_AREA,0,7;SDATE \"SDATE\" true true false 8 Date 0 0,First,#,SDEADM.ADM_waste_coll_area,SDATE,-1,-1;WR_COMMENT \"WR_COMMENT\" true true false 100 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,WR_COMMENT,0,100;CONTRACTOR \"CONTRACTOR\" true true false 32 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,CONTRACTOR,0,32;UNIQUE_ID \"UNIQUE_ID\" true true false 4 Long 0 10,First,#,SDEADM.ADM_waste_coll_area,UNIQUE_ID,-1,-1;SACC \"SACC\" true true false 2 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,SACC,0,2;SOURCE \"SOURCE\" true true false 12 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,SOURCE,0,12;RECYCLEFRQ \"RECYCLEFRQ\" true true false 50 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,RECYCLEFRQ,0,50;CONTACT_PH \"CONTACT_PH\" true true false 15 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,CONTACT_PH,0,15;ORG_PILOT \"ORG_PILOT\" true true false 1 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,ORG_PILOT,0,1;COLL_SCHED \"COLL_SCHED\" true true false 8 Text 0 0,First,#,SDEADM.ADM_waste_coll_area,COLL_SCHED,0,8;GLOBALID \"GLOBALID\" false false true 38 GlobalID 0 0,First,#,SDEADM.ADM_waste_coll_area,GLOBALID,-1,-1", config_keyword="")[0]

    # Process: Spatial Join (Spatial Join) (analysis)
    BuildingPolygon_COLL_AREA = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\BuildingPolygon_COLL_AREA"
    arcpy.analysis.SpatialJoin(target_features=Building_Polygons_Dissolve, join_features=Waste_Collection_Areas_2_, out_feature_class=BuildingPolygon_COLL_AREA, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="BL_ID \"BL_ID\" true true false 16 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Building_Polygons_Dissolve,BL_ID,0,16;OPERATOR \"OPERATOR\" true true false 8 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,OPERATOR,0,8;COLLECT \"COLLECT\" true true false 10 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,COLLECT,0,10;COLL_AREA \"COLL_AREA\" true true false 7 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,COLL_AREA,0,7;SDATE \"SDATE\" true true false 8 Date 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,SDATE,-1,-1;WR_COMMENT \"WR_COMMENT\" true true false 100 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,WR_COMMENT,0,100;CONTRACTOR \"CONTRACTOR\" true true false 32 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,CONTRACTOR,0,32;UNIQUE_ID \"UNIQUE_ID\" true true false 4 Long 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,UNIQUE_ID,-1,-1;SACC \"SACC\" true true false 2 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,SACC,0,2;SOURCE \"SOURCE\" true true false 12 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,SOURCE,0,12;RECYCLEFRQ \"RECYCLEFRQ\" true true false 50 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,RECYCLEFRQ,0,50;CONTACT_PH \"CONTACT_PH\" true true false 15 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,CONTACT_PH,0,15;ORG_PILOT \"ORG_PILOT\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,ORG_PILOT,0,1;COLL_SCHED \"COLL_SCHED\" true true false 8 Text 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,COLL_SCHED,0,8;GLOBALID \"GLOBALID\" false false false 38 GlobalID 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,GLOBALID,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\Waste_Collection_Areas,Shape_Area,-1,-1", match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Table To Table (Table To Table) (conversion)
    Building_Use = arcpy.conversion.TableToTable(in_rows=SDEADM_BLD_BUILDING_USE_2_, out_path=SolidWaste_DwellingUnitAnalysis_gdb_2_, out_name="Building_Use", where_clause="", field_mapping="USE_ID \"USE_ID\" false true false 16 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,USE_ID,0,16;BL_ID \"BL_ID\" true true false 16 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,BL_ID,0,16;CLASS \"Classification\" true true false 2 Short 0 5,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,CLASS,-1,-1;USE \"Use\" true true false 50 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,USE,0,50;USE_NAME \"Use Name\" true true false 100 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,USE_NAME,0,100;DWEL_UNITS \"Dwelling Units\" true true false 2 Short 0 5,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,DWEL_UNITS,-1,-1;USE_SQFT \"Usage SqFt\" true true false 4 Long 0 10,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,USE_SQFT,-1,-1;PRIM_USE \"Primary Use?\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,PRIM_USE,0,1;WEBURL \"Website URL\" true true false 100 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,WEBURL,0,100;ADDDATE \"ADDDATE\" false true false 8 Date 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,ADDDATE,-1,-1;SOURCE \"SOURCE\" true true false 15 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,SOURCE,0,15;SACC \"SACC\" true true false 2 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,SACC,0,2;MODDATE \"MODDATE\" false true false 8 Date 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,MODDATE,-1,-1;GLOBALID \"GLOBALID\" false false false 38 GlobalID 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,GLOBALID,-1,-1;SPRINKLER \"Sprinklered\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,SPRINKLER,0,1;FIREALARMS \"Fire Alarms\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,FIREALARMS,0,1;COMBUSCONS \"Combustible Construction\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,COMBUSCONS,0,1;OCCCLASS \"Occupancy Class\" true true false 2 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,OCCCLASS,0,2;OCCLOAD \"Occupancy Load\" true true false 2 Short 0 5,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,OCCLOAD,-1,-1;LICENS_LIQ \"Liquor License\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,LICENS_LIQ,0,1;LOAD_ID \"Load ID\" true true false 16 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,LOAD_ID,0,16;OCC_VER \"OccClass Verified\" true true false 1 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,OCC_VER,0,1;OCC_VERDTE \"OccClass Verified Date\" true true false 8 Date 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,OCC_VERDTE,-1,-1;ADDBY \"Add by\" false true false 32 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,ADDBY,0,32;MODBY \"Modified by\" false true false 32 Text 0 0,First,#,C:\\Users\\otoolel\\AppData\\Roaming\\Esri\\ArcGISPro\\Favorites\\Prod_GIS_Halifax.sde\\SDEADM.BLD_BUILDING_USE,MODBY,0,32", config_keyword="")[0]

    # Process: Join Field (2) (Join Field) (management)
    BuildingPolygon_COLL_AREA_2_ = arcpy.management.JoinField(in_data=BuildingPolygon_COLL_AREA, in_field="BL_ID", join_table=Building_Use, join_field="BL_ID", fields=[])[0]

    # Process: Summarize Attributes (Summarize Attributes) (gapro)
    BuildingUse_Summarize = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\SolidWaste_DwellingUnitAnalysis.gdb\\BuildingUse_Summarize"
    arcpy.gapro.SummarizeAttributes(input_layer=BuildingPolygon_COLL_AREA_2_, out_table=BuildingUse_Summarize, fields=["BL_ID", "COLL_AREA"], summary_fields=[["DWEL_UNITS", "SUM"]])

    # Process: Select Layer By Attribute (Select Layer By Attribute) (management)
    BuildingUse_Summarize_View, Count = arcpy.management.SelectLayerByAttribute(in_layer_or_view=BuildingUse_Summarize, selection_type="NEW_SELECTION", where_clause="SUM_DWEL_UNITS <= 6 And SUM_DWEL_UNITS <> 0", invert_where_clause="")

    # Process: Table To Excel (Table To Excel) (conversion)
    Building_Dwellings_Summarized_xlsx = "C:\\Users\\otoolel\\Documents\\ArcGIS\\Projects\\SolidWaste_DwellingUnitAnalysis\\Building_Dwellings_Summarized_.xlsx"
    arcpy.conversion.TableToExcel(Input_Table=BuildingUse_Summarize_View, Output_Excel_File=Building_Dwellings_Summarized_xlsx, Use_field_alias_as_column_header="ALIAS", Use_domain_and_subtype_description="CODE")

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"C:\Users\gallaga\AppData\Local\Temp\ArcGISProTemp54332\2ca25bff-45b4-4fbc-af07-940d5f7ada34\Default.gdb", workspace=r"C:\Users\gallaga\AppData\Local\Temp\ArcGISProTemp54332\2ca25bff-45b4-4fbc-af07-940d5f7ada34\Default.gdb"):
        SolidWasteDwellingUnits()
